# =================================================================
#                             Geodata
# =================================================================

# GeoData are now !MANDATORY! to start a server due to following reasons:
#   * Usage of doors and admin fences
#   * Future usage for new npc spawn manager

# Specifies the path to geodata files. For example, when using geodata files located
# at different folder/harddrive ("C:/Program Files/Lineage II/system/geodata/"), default: ./data/geodata/
# Note: When L2OFF geodata are present in "Lineage II/system/geodata/" folder, the ingame client
# command ///geodata is enabled. This command allows player with admin rights to visually see geodata. 
GeoDataPath = ./data/geodata/

# Specifies the geodata files type. Default: L2J
# L2J: Using L2J geodata files (filename e.g. 22_16.l2j)
# L2OFF: Using L2OFF geodata files (filename e.g. 22_16_conv.dat)
GeoDataType = L2OFF

# If some NPCs spawn on roofs due to multilayer geodata, bias NPC Z search
# downwards by this many units when resolving spawn height. Example: 32
# Set 0 to disable. Default: 0
NpcZindex = 32

# =================================================================
#                             Movement
# =================================================================

# Maximum amount of authorized geopath fails before sending a log warning.
# You can't go below 15 for proper AI execution.
MaxGeopathFailCount = 30

# =================================================================
#                           Line of Sight
# =================================================================

# Line of sight start at X percent of the character height, default: 75
PartOfCharacterHeight = 75

# Maximum height of an obstacle, which can exceed the line of sight, default: 32
MaxObstacleHeight = 32

# =================================================================
#                           Pathfinding
# =================================================================
# Movement weight, when moving from one to another axially and diagonally, default: 10 and 14
MoveWeight = 10
MoveWeightDiag = 14

# When movement flags of target node is blocked to any direction, use this weight instead of MoveWeight or MoveWeightDiag.
# This causes pathfinding algorithm to avoid path construction exactly near an obstacle, default: 30
ObstacleWeight = 30

# Weight of the heuristic algorithm, which is giving estimated cost from node to target, default: 12
# For proper function must be higher than MoveWeight.
HeuristicWeight = 12

# Maximum number of generated nodes per one path-finding process, default 10000
MaxIterations = 10000

# =================================================================
#                    Sistema de Movimento Otimizado
# =================================================================

# ┌─────────────────────────────────────────────────────────────┐
# │ MODO EXTREMO DE PERFORMANCE (Servidores com Poucos Recursos) │
# └─────────────────────────────────────────────────────────────┘
# UseMinimalGeoOnly = True ativa o modo EXTREMO de economia de recursos
# 
# O QUE FAZ:
# ✓ NÃO carrega GeoEngine (legado) na memória
# ✓ NÃO carrega GeoEngineOptimized na memória
# ✓ USA apenas GeoEngineMinimal (código mínimo)
# ✓ SEM verificação de obstáculos/paredes
# ✓ SEM cálculo de pathfinding
# ✓ Players podem se movimentar normalmente (mas atravessam paredes)
# 
# ECONOMIA ESTIMADA:
# - ~300-800 MB de RAM 
# - ~50-70% menos processamento em movimento
# 
# QUANDO USAR:
# - Servidor com menos de 2GB RAM disponível
# - VPS/Dedicado com processador fraco
# - Servidor de testes/desenvolvimento
# - Rate server onde pathfinding não é crítico
# 
# ATENÇÃO: Players poderão atravessar paredes e obstáculos!
# Padrão: False
UseMinimalGeoOnly = False

# ┌──────────────────────────────────────────────────────────────┐
# │ CONFIGURAÇÕES NORMAIS (Ignoradas se UseMinimalGeoOnly = True) │
# └──────────────────────────────────────────────────────────────┘

# Ativa/desativa completamente o sistema de pathfinding (legado E otimizado)
# Quando False, desativa AMBOS os sistemas de pathfinding
# O servidor usará GeoEngineMinimal (movimento direto sem calcular paths)
# Útil para servidores de teste com pouca RAM
# ATENÇÃO: False = sem pathfinding em todo o servidor (legado e otimizado)
# Padrão: True
SistemaPathfinding = True

# Ativa o sistema de movimento otimizado (fidelidade L2OFF)
# Padrão: True
UseOptimizedMovement = True

# Habilita predição do lado do cliente para resposta instantânea
# Padrão: True
EnableClientSidePrediction = True

# Intervalo em milissegundos para validação de posição
# Padrão: 500
MovementValidationInterval = 500

# Limite de distância para reconciliação de posição
# Padrão: 32.0
MovementReconciliationThreshold = 32.0

# Máximo de nós a serem explorados no pathfinding (previne lag)
# Padrão: 1500
PathfindingMaxNodes = 1500

# Máximo de iterações para o algoritmo de pathfinding
# Padrão: 2000
PathfindingMaxIterations = 2000

# Habilita suavização de caminho para movimento natural
# Padrão: True
EnablePathSmoothing = True

# Tamanho do cache do GeoEngine para performance
# Padrão: 50000
GeoEngineCacheSize = 50000

# Habilita cache de pathfinding para reutilizar caminhos calculados
# Padrão: True
EnablePathfindingCache = True

# Tamanho do cache de pathfinding (número de caminhos armazenados)
# Valores maiores = mais memória usada, mas menos recálculos
# Padrão: 5000
PathfindingCacheSize = 5000

# Tempo em segundos para expiração de caminhos no cache
# Após esse tempo, o caminho é removido e recalculado se necessário
# Padrão: 30
PathfindingCacheExpiration = 30

# Número de threads dedicadas ao pathfinding
# -1 = Automático (usa número de núcleos da CPU)
# 0 = Desabilitado (processa no thread principal)
# 1+ = Número específico de threads
# Padrão: -1
PathfindingThreads = -1

# =================================================================
#                    Contorno Suave de Obstáculos
# =================================================================

# Habilita contorno suave de obstáculos para movimento natural
# Padrão: True
EnableSmoothObstacleAvoidance = True

# Distância em unidades para suavização das bordas de obstáculos
# Valores maiores = contornos mais suaves, valores menores = contornos mais diretos
# Padrão: 50
ObstacleSmoothingDistance = 50

# Distância mínima para considerar um obstáculo próximo
# Padrão: 32
ObstacleDetectionDistance = 32

# Nível de suavização do pathfinding (1-10)
# 1 = Contorno mínimo, 10 = Contorno máximo suave
# Padrão: 7
PathfindingSmoothingLevel = 7

# Habilita contorno em tempo real durante movimento
# Padrão: True
EnableRealTimeObstacleAvoidance = True

# ----------------------------------------------------------------
# Tolerância de Altura para Linha de Visão (canSee)
# ----------------------------------------------------------------
# Define quanto de diferença de altura é tolerada ao verificar
# linha de visão entre player e monstro.
#
# Valor padrão: 80 (recomendado para terrenos normais)
# Terrenos muito desnivelados: 120-150
# Terrenos planos: 50-80
#
# Valores mais altos = mais permissivo (menos bloqueios falsos)
# Valores mais baixos = mais restritivo (mais preciso)
GeoHeightTolerance = 250

# ----------------------------------------------------------------
# Distância Considerada "Curta" para Movimentação
# ----------------------------------------------------------------
# Distâncias abaixo deste valor usam verificação mais permissiva.
# Ajuda em movimentos pequenos em terrenos irregulares.
#
# Valor padrão: 200 (equivale a aproximadamente 2-3 células de jogo)
# Para mais fluidez: 300-400
# Para mais precisão: 100-150
ShortDistanceThreshold = 200

# ----------------------------------------------------------------
# Diferença Máxima de Altura para Distâncias Curtas
# ----------------------------------------------------------------
# Em movimentos curtos, permite uma diferença de altura maior
# sem bloquear o movimento.
#
# Valor padrão: 200 (permite subir/descer escadas e pequenas elevações)
# Terrenos montanhosos: 300-400
# Terrenos planos: 100-150
MaxShortDistanceHeightDiff = 424

# ----------------------------------------------------------------
# Bloqueios Consecutivos Máximos
# ----------------------------------------------------------------
# Número de pontos consecutivamente bloqueados necessários
# para considerar o caminho realmente bloqueado.
#
# Valor padrão: 3 (equilibrado)
# Mais tolerante: 4-5 (reduz bloqueios falsos)
# Mais restritivo: 1-2 (mais preciso, pode causar mais bloqueios)
#
# ATENÇÃO: Valores muito altos (>5) podem permitir atravessar paredes!
MaxConsecutiveBlocks = 3

# =================================================================
#                   Otimização de Movimento de NPCs
# =================================================================

# Habilita otimização de movimento para NPCs sem players por perto
# Quando ativado, NPCs param de processar movimento quando não há
# players visíveis no range especificado, economizando processamento
# Padrão: True
EnableNpcMovementOptimization = True

# Range em unidades para detectar players visíveis
# NPCs só processam movimento se houver players neste range
# Valores maiores = mais processamento (mais realista)
# Valores menores = menos processamento (mais economia)
# Padrão: 2000 (range médio de visão)
# Recomendado para economia máxima: 1500
# Recomendado para realismo: 2500-3000
# NOTA: 0 ou valores negativos desabilitam a otimização
NpcMovementPlayerRange = 2000

# =================================================================
#                          Geodata files
# =================================================================

# The world contains 176 regions (11 x 16), each region has own geodata file.
# Geodata files are loaded according to the list below.
#   16_10:	load region (geodata options are enabled)
#			Server will not start, until all enabled regions are loaded properly.
#   #16_10:	skip region (geodata options are disabled)
#			Disabled regions will be considered as in "everything-allowed" mode.
#			Monster aggression/attacks/spellcast/movement will pass though walls and other obstacles, no pathfinding will be used.
# Some regions are not supported by L2 client.
16_10
16_11
16_12
#16_13 - not supported by L2 client
#16_14 - not supported by L2 client
#16_15 - not supported by L2 client
#16_16 - not supported by L2 client
#16_17 - not supported by L2 client
#16_18 - not supported by L2 client
16_19
16_20
16_21
16_22
16_23
16_24
16_25
17_10
17_11
17_12
#17_13 - not supported by L2 client
#17_14 - not supported by L2 client
#17_15 - not supported by L2 client
#17_16 - not supported by L2 client
#17_17 - not supported by L2 client
17_18
17_19
17_20
17_21
17_22
17_23
17_24
17_25
18_10
18_11
18_12
18_13
18_14
#18_15 - not supported by L2 client
#18_16 - not supported by L2 client
18_17
18_18
18_19
18_20
18_21
18_22
18_23
18_24
18_25
19_10
19_11
#19_12 - not supported by L2 client
19_13
19_14
19_15
19_16
19_17
19_18
19_19
19_20
19_21
19_22
19_23
19_24
19_25
20_10
20_11
#20_12 - not supported by L2 client
20_13
20_14
20_15
20_16
20_17
20_18
20_19
20_20
20_21
20_22
20_23
20_24
20_25
#21_10 - not supported by L2 client
#21_11 - not supported by L2 client
#21_12 - not supported by L2 client
21_13
21_14
21_15
21_16
21_17
21_18
21_19
21_20
21_21
21_22
21_23
21_24
21_25
#22_10 - not supported by L2 client
#22_11 - not supported by L2 client
#22_12 - not supported by L2 client
22_13
22_14
22_15
22_16
22_17
22_18
22_19
22_20
22_21
22_22
22_23
22_24
22_25
23_10
23_11
23_12
23_13
23_14
23_15
23_16
23_17
23_18
23_19
23_20
23_21
23_22
23_23
23_24
23_25
24_10
24_11
24_12
24_13
24_14
24_15
24_16
24_17
24_18
24_19
24_20
24_21
24_22
24_23
24_24
24_25
25_10
25_11
25_12
#25_13 - not supported by L2 client
25_14
25_15
25_16
25_17
25_18
25_19
25_20
25_21
#25_22 - not supported by L2 client
#25_23 - not supported by L2 client
#25_24 - not supported by L2 client
#25_25 - not supported by L2 client
#26_10 - not supported by L2 client
26_11
26_12
#26_13 - not supported by L2 client
26_14
26_15
26_16
#26_17 - not supported by L2 client
#26_18 - not supported by L2 client
#26_19 - not supported by L2 client
#26_20 - not supported by L2 client
#26_21 - not supported by L2 client
#26_22 - not supported by L2 client
#26_23 - not supported by L2 client
#26_24 - not supported by L2 client
#26_25 - not supported by L2 client

# =================================================================
#                    GUIA DE CONFIGURAÇÃO
# =================================================================
# 
# ┌─────────────────────────────────────────────────────────────────┐
# │ CENÁRIO 1: Servidor com POUQUÍSSIMOS recursos (< 2GB RAM)       │
# └─────────────────────────────────────────────────────────────────┘
# UseMinimalGeoOnly = True
# SistemaPathfinding = True (será forçado para False automaticamente)
# UseOptimizedMovement = True (será forçado para False automaticamente)
# 
# RESULTADO: Usa apenas GeoEngineMinimal
# - NÃO carrega geodata na RAM
# - NÃO calcula pathfinding
# - Players atravessam paredes
# - Economia: ~300-800 MB RAM + 50-70% CPU
# 
# ┌─────────────────────────────────────────────────────────────────┐
# │ CENÁRIO 2: Servidor com poucos recursos mas quer pathfinding    │
# └─────────────────────────────────────────────────────────────────┘
# UseMinimalGeoOnly = False
# SistemaPathfinding = True
# UseOptimizedMovement = False
# 
# RESULTADO: Usa GeoEngine (legado)
# - Carrega geodata completa
# - Pathfinding funcional básico
# - Menor uso de CPU que o otimizado
# 
# ┌─────────────────────────────────────────────────────────────────┐
# │ CENÁRIO 3: Servidor balanceado (recomendado)                    │
# └─────────────────────────────────────────────────────────────────┘
# UseMinimalGeoOnly = False
# SistemaPathfinding = True
# UseOptimizedMovement = True
# 
# RESULTADO: Usa GeoEngineOptimized
# - Carrega geodata completa
# - Pathfinding otimizado e cache
# - Melhor fidelidade L2OFF
# - Uso balanceado de recursos
# 
# ┌─────────────────────────────────────────────────────────────────┐
# │ CENÁRIO 4: Servidor de testes rápidos (sem geodata)             │
# └─────────────────────────────────────────────────────────────────┘
# UseMinimalGeoOnly = False
# SistemaPathfinding = False
# UseOptimizedMovement = False
# 
# RESULTADO: Usa GeoEngineMinimal via MovementIntegration
# - NÃO carrega geodata
# - Funciona similar ao UseMinimalGeoOnly
# - Útil para testes de scripts/eventos

